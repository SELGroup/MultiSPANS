nohup: ignoring input
/home/bao/xfli/course/tst/ST_transformer/libcity/pipeline/pipeline.py:3: DeprecationWarning: The module `ray.tune.suggest` has been moved to `ray.tune.search` and the old location will be deprecated soon. Please adjust your imports to point to the new location. Example: Do a global search and replace `ray.tune.suggest` with `ray.tune.search`.
  from ray.tune.suggest.hyperopt import HyperOptSearch
/home/bao/xfli/course/tst/ST_transformer/libcity/pipeline/pipeline.py:3: DeprecationWarning: The module `ray.tune.suggest.hyperopt` has been moved to `ray.tune.search.hyperopt` and the old location will be deprecated soon. Please adjust your imports to point to the new location. Example: Do a global search and replace `ray.tune.suggest.hyperopt` with `ray.tune.search.hyperopt`.
  from ray.tune.suggest.hyperopt import HyperOptSearch
/home/bao/xfli/course/tst/ST_transformer/libcity/pipeline/pipeline.py:4: DeprecationWarning: The module `ray.tune.suggest.bayesopt` has been moved to `ray.tune.search.bayesopt` and the old location will be deprecated soon. Please adjust your imports to point to the new location. Example: Do a global search and replace `ray.tune.suggest.bayesopt` with `ray.tune.search.bayesopt`.
  from ray.tune.suggest.bayesopt import BayesOptSearch
/home/bao/xfli/course/tst/ST_transformer/libcity/pipeline/pipeline.py:5: DeprecationWarning: The module `ray.tune.suggest.basic_variant` has been moved to `ray.tune.search.basic_variant` and the old location will be deprecated soon. Please adjust your imports to point to the new location. Example: Do a global search and replace `ray.tune.suggest.basic_variant` with `ray.tune.search.basic_variant`.
  from ray.tune.suggest.basic_variant import BasicVariantGenerator
2023-05-11 23:02:10,452 - INFO - Log directory: ./libcity/log
2023-05-11 23:02:10,452 - INFO - Begin pipeline, task=traffic_state_pred, model_name=STTransformer, dataset_name=PEMSD4, exp_id=94315
2023-05-11 23:02:10,452 - INFO - {'task': 'traffic_state_pred', 'model': 'STTransformer', 'dataset': 'PEMSD4', 'saved_model': False, 'train': True, 'seed': 0, 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutorTest', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 64, 'skip_conv_flag': False, 'residual_conv_flag': False, 'skip_dim': 64, 'num_layers': 3, 'num_heads': 8, 'conv_kernels': [1, 2, 3, 6], 'conv_stride': 1, 'conv_if_gc': True, 'norm_type': 'BatchNorm', 'gconv_hop_num': 3, 'gconv_alpha': 0, 'att_dropout': 0.1, 'ffn_dropout': 0.1, 'Satt_pe_type': 'laplacian', 'Spe_learnable': False, 'Tatt_pe_type': 'sincos', 'Tpe_learnable': False, 'Smask_flag': True, 'block_forward_mode': 0, 'batch_size': 32, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.6, 'eval_rate': 0.2, 'scaler': 'standardindependc', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'input_window': 12, 'output_window': 12, 'add_time_in_day': False, 'add_day_in_week': False, 'gpu': True, 'gpu_id': 0, 'max_epoch': 100, 'train_loss': 'masked_mae', 'epoch': 0, 'learner': 'adam', 'learning_rate': 0.01, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_decay': False, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'clip_grad_norm': False, 'max_grad_norm': 1.0, 'use_early_stop': False, 'patience': 50, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'if_test_epoch': True, 'if_inv_loss': True, 'if_inv_eval': True, 'pred_channel_idx': [0], 'outfeat_dim': 1, 'metrics': ['MAE', 'MAPE', 'MSE', 'RMSE', 'masked_MAE', 'masked_MAPE', 'masked_MSE', 'masked_RMSE', 'R2', 'EVAR'], 'evaluator_mode': 'average', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_flow': 'num', 'traffic_occupancy': 'num', 'traffic_speed': 'num'}}, 'data_col': ['traffic_flow', 'traffic_occupancy', 'traffic_speed'], 'weight_col': 'cost', 'data_files': ['PEMSD4'], 'geo_file': 'PEMSD4', 'rel_file': 'PEMSD4', 'output_dim': 3, 'time_intervals': 300, 'init_weight_inf_or_zero': 'zero', 'set_weight_link_or_dist': 'link', 'calculate_weight_adj': False, 'weight_adj_epsilon': 0.1, 'device': device(type='cuda', index=0), 'exp_id': 94315}
2023-05-11 23:02:10,456 - INFO - Loaded file PEMSD4.geo, num_nodes=307
2023-05-11 23:02:10,458 - INFO - set_weight_link_or_dist: link
2023-05-11 23:02:10,458 - INFO - init_weight_inf_or_zero: zero
2023-05-11 23:02:10,460 - INFO - Loaded file PEMSD4.rel, shape=(307, 307)
2023-05-11 23:02:10,460 - INFO - Loading file PEMSD4.dyna
2023-05-11 23:02:13,716 - INFO - Loaded file PEMSD4.dyna, shape=(16992, 307, 3)
2023-05-11 23:02:17,488 - INFO - Dataset created
2023-05-11 23:02:17,489 - INFO - x shape: (16969, 12, 307, 3), y shape: (16969, 12, 307, 3)
2023-05-11 23:02:17,495 - INFO - train	x: (10181, 12, 307, 3), y: (10181, 12, 307, 3)
2023-05-11 23:02:17,495 - INFO - eval	x: (3394, 12, 307, 3), y: (3394, 12, 307, 3)
2023-05-11 23:02:17,495 - INFO - test	x: (3394, 12, 307, 3), y: (3394, 12, 307, 3)
2023-05-11 23:02:18,388 - INFO - NoneScaler
2023-05-11 23:02:25,248 - INFO - STTransformer(
  (patchencoder): patching_STconv(
    (paddings): ModuleList(
      (0): ReplicationPad1d((0, 0))
      (1): ReplicationPad1d((0, 1))
      (2): ReplicationPad1d((1, 1))
      (3): ReplicationPad1d((2, 3))
    )
    (tconvs): ModuleList(
      (0): Conv1d(3, 4, kernel_size=(1,), stride=(1,))
      (1): Conv1d(3, 4, kernel_size=(2,), stride=(1,))
      (2): Conv1d(3, 4, kernel_size=(3,), stride=(1,))
      (3): Conv1d(3, 4, kernel_size=(6,), stride=(1,))
    )
    (gconv): MixhopConv()
    (norm): Sequential(
      (0): Permution()
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): Permution()
    )
    (activation): Tanh()
  )
  (nodePEencoder): S_Positional_Encoding(
    (pe_encoder): LaplacianPE(
      (embedding_lap_pos_enc): Linear(in_features=154, out_features=64, bias=True)
    )
  )
  (tseqPEencoder): Positional_Encoding()
  (STencoders): ModuleList(
    (0): STBlock(
      (STransformer): _ST_Transfomer(
        (attention): _ST_Attention(
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (values_proj): Linear(in_features=64, out_features=64, bias=True)
          (keys_proj): Linear(in_features=64, out_features=64, bias=True)
          (queries_proj): Linear(in_features=64, out_features=64, bias=True)
          (att_dropout_layer): Dropout(p=0.1, inplace=False)
          (fc_out): Linear(in_features=64, out_features=64, bias=True)
        )
        (drop_attn): Dropout(p=0.1, inplace=False)
        (norm_attn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (feed_forward): Sequential(
          (0): Linear(in_features=64, out_features=256, bias=True)
          (1): Dropout(p=0.1, inplace=False)
          (2): ReLU()
          (3): Linear(in_features=256, out_features=64, bias=True)
        )
        (norm_ffn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (dropout_ffn): Dropout(p=0.1, inplace=False)
      )
      (TTransformer): _ST_Transfomer(
        (attention): _ST_Attention(
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (values_proj): Linear(in_features=64, out_features=64, bias=True)
          (keys_proj): Linear(in_features=64, out_features=64, bias=True)
          (queries_proj): Linear(in_features=64, out_features=64, bias=True)
          (att_dropout_layer): Dropout(p=0.1, inplace=False)
          (fc_out): Linear(in_features=64, out_features=64, bias=True)
        )
        (drop_attn): Dropout(p=0.1, inplace=False)
        (norm_attn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (feed_forward): Sequential(
          (0): Linear(in_features=64, out_features=256, bias=True)
          (1): Dropout(p=0.1, inplace=False)
          (2): ReLU()
          (3): Linear(in_features=256, out_features=64, bias=True)
        )
        (norm_ffn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (dropout_ffn): Dropout(p=0.1, inplace=False)
      )
      (norm1): Sequential(
        (0): Permution()
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): Permution()
      )
      (norm2): Sequential(
        (0): Permution()
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): Permution()
      )
      (dropout_layer): Dropout(p=0.1, inplace=False)
    )
    (1): STBlock(
      (STransformer): _ST_Transfomer(
        (attention): _ST_Attention(
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (values_proj): Linear(in_features=64, out_features=64, bias=True)
          (keys_proj): Linear(in_features=64, out_features=64, bias=True)
          (queries_proj): Linear(in_features=64, out_features=64, bias=True)
          (att_dropout_layer): Dropout(p=0.1, inplace=False)
          (fc_out): Linear(in_features=64, out_features=64, bias=True)
        )
        (drop_attn): Dropout(p=0.1, inplace=False)
        (norm_attn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (feed_forward): Sequential(
          (0): Linear(in_features=64, out_features=256, bias=True)
          (1): Dropout(p=0.1, inplace=False)
          (2): ReLU()
          (3): Linear(in_features=256, out_features=64, bias=True)
        )
        (norm_ffn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (dropout_ffn): Dropout(p=0.1, inplace=False)
      )
      (TTransformer): _ST_Transfomer(
        (attention): _ST_Attention(
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (values_proj): Linear(in_features=64, out_features=64, bias=True)
          (keys_proj): Linear(in_features=64, out_features=64, bias=True)
          (queries_proj): Linear(in_features=64, out_features=64, bias=True)
          (att_dropout_layer): Dropout(p=0.1, inplace=False)
          (fc_out): Linear(in_features=64, out_features=64, bias=True)
        )
        (drop_attn): Dropout(p=0.1, inplace=False)
        (norm_attn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (feed_forward): Sequential(
          (0): Linear(in_features=64, out_features=256, bias=True)
          (1): Dropout(p=0.1, inplace=False)
          (2): ReLU()
          (3): Linear(in_features=256, out_features=64, bias=True)
        )
        (norm_ffn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (dropout_ffn): Dropout(p=0.1, inplace=False)
      )
      (norm1): Sequential(
        (0): Permution()
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): Permution()
      )
      (norm2): Sequential(
        (0): Permution()
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): Permution()
      )
      (dropout_layer): Dropout(p=0.1, inplace=False)
    )
    (2): STBlock(
      (STransformer): _ST_Transfomer(
        (attention): _ST_Attention(
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (values_proj): Linear(in_features=64, out_features=64, bias=True)
          (keys_proj): Linear(in_features=64, out_features=64, bias=True)
          (queries_proj): Linear(in_features=64, out_features=64, bias=True)
          (att_dropout_layer): Dropout(p=0.1, inplace=False)
          (fc_out): Linear(in_features=64, out_features=64, bias=True)
        )
        (drop_attn): Dropout(p=0.1, inplace=False)
        (norm_attn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (feed_forward): Sequential(
          (0): Linear(in_features=64, out_features=256, bias=True)
          (1): Dropout(p=0.1, inplace=False)
          (2): ReLU()
          (3): Linear(in_features=256, out_features=64, bias=True)
        )
        (norm_ffn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (dropout_ffn): Dropout(p=0.1, inplace=False)
      )
      (TTransformer): _ST_Transfomer(
        (attention): _ST_Attention(
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (values_proj): Linear(in_features=64, out_features=64, bias=True)
          (keys_proj): Linear(in_features=64, out_features=64, bias=True)
          (queries_proj): Linear(in_features=64, out_features=64, bias=True)
          (att_dropout_layer): Dropout(p=0.1, inplace=False)
          (fc_out): Linear(in_features=64, out_features=64, bias=True)
        )
        (drop_attn): Dropout(p=0.1, inplace=False)
        (norm_attn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (feed_forward): Sequential(
          (0): Linear(in_features=64, out_features=256, bias=True)
          (1): Dropout(p=0.1, inplace=False)
          (2): ReLU()
          (3): Linear(in_features=256, out_features=64, bias=True)
        )
        (norm_ffn): Sequential(
          (0): Permution()
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): Permution()
        )
        (dropout_ffn): Dropout(p=0.1, inplace=False)
      )
      (norm1): Sequential(
        (0): Permution()
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): Permution()
      )
      (norm2): Sequential(
        (0): Permution()
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): Permution()
      )
      (dropout_layer): Dropout(p=0.1, inplace=False)
    )
  )
  (lineardecoder): depatching_conv(
    (padding): ReplicationPad1d((0, 0))
    (tconv): ConvTranspose1d(64, 32, kernel_size=(1,), stride=(1,))
    (seqlin): Sequential(
      (0): Linear(in_features=12, out_features=12, bias=True)
      (1): Permution()
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
    (activation): Tanh()
  )
  (droput_layer): Dropout(p=0.1, inplace=False)
)
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.0.weight	torch.Size([4, 3, 1])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.0.bias	torch.Size([4])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.1.weight	torch.Size([4, 3, 2])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.1.bias	torch.Size([4])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.2.weight	torch.Size([4, 3, 3])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.2.bias	torch.Size([4])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.3.weight	torch.Size([4, 3, 6])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.tconvs.3.bias	torch.Size([4])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.norm.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - patchencoder.norm.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - nodePEencoder.pe_encoder.embedding_lap_pos_enc.weight	torch.Size([64, 154])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - nodePEencoder.pe_encoder.embedding_lap_pos_enc.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - STencoders.0.STransformer.attention.values_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - STencoders.0.STransformer.attention.values_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - STencoders.0.STransformer.attention.keys_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - STencoders.0.STransformer.attention.keys_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - STencoders.0.STransformer.attention.queries_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,250 - INFO - STencoders.0.STransformer.attention.queries_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.attention.fc_out.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.attention.fc_out.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.norm_attn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.norm_attn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.feed_forward.0.weight	torch.Size([256, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.feed_forward.0.bias	torch.Size([256])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.feed_forward.3.weight	torch.Size([64, 256])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.feed_forward.3.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.norm_ffn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.STransformer.norm_ffn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.values_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.values_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.keys_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.keys_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.queries_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.queries_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.fc_out.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.attention.fc_out.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.norm_attn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.norm_attn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.feed_forward.0.weight	torch.Size([256, 64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.feed_forward.0.bias	torch.Size([256])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.feed_forward.3.weight	torch.Size([64, 256])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.feed_forward.3.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.norm_ffn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.TTransformer.norm_ffn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.norm1.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,251 - INFO - STencoders.0.norm1.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.0.norm2.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.0.norm2.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.values_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.values_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.keys_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.keys_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.queries_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.queries_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.fc_out.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.attention.fc_out.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.norm_attn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.norm_attn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.feed_forward.0.weight	torch.Size([256, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.feed_forward.0.bias	torch.Size([256])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.feed_forward.3.weight	torch.Size([64, 256])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.feed_forward.3.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.norm_ffn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.STransformer.norm_ffn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.values_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.values_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.keys_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.keys_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.queries_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.queries_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.fc_out.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.attention.fc_out.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.norm_attn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,252 - INFO - STencoders.1.TTransformer.norm_attn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.TTransformer.feed_forward.0.weight	torch.Size([256, 64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.TTransformer.feed_forward.0.bias	torch.Size([256])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.TTransformer.feed_forward.3.weight	torch.Size([64, 256])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.TTransformer.feed_forward.3.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.TTransformer.norm_ffn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.TTransformer.norm_ffn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.norm1.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.norm1.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.norm2.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.1.norm2.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.values_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.values_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.keys_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.keys_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.queries_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.queries_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.fc_out.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.attention.fc_out.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.norm_attn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.norm_attn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.feed_forward.0.weight	torch.Size([256, 64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.feed_forward.0.bias	torch.Size([256])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.feed_forward.3.weight	torch.Size([64, 256])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.feed_forward.3.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.norm_ffn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.STransformer.norm_ffn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,253 - INFO - STencoders.2.TTransformer.attention.values_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.values_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.keys_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.keys_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.queries_proj.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.queries_proj.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.fc_out.weight	torch.Size([64, 64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.attention.fc_out.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.norm_attn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.norm_attn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.feed_forward.0.weight	torch.Size([256, 64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.feed_forward.0.bias	torch.Size([256])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.feed_forward.3.weight	torch.Size([64, 256])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.feed_forward.3.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.norm_ffn.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.TTransformer.norm_ffn.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.norm1.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.norm1.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.norm2.1.weight	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - STencoders.2.norm2.1.bias	torch.Size([64])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - lineardecoder.tconv.weight	torch.Size([64, 32, 1])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - lineardecoder.tconv.bias	torch.Size([32])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - lineardecoder.seqlin.0.weight	torch.Size([12, 12])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - lineardecoder.seqlin.0.bias	torch.Size([12])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - lineardecoder.seqlin.2.weight	torch.Size([1, 32])	cuda:0	True
2023-05-11 23:02:25,254 - INFO - lineardecoder.seqlin.2.bias	torch.Size([1])	cuda:0	True
2023-05-11 23:02:25,255 - INFO - Total parameter numbers: 313149
2023-05-11 23:02:25,255 - INFO - You select `adam` optimizer.
2023-05-11 23:02:25,255 - INFO - You select `masked_mae` as train loss function.
2023-05-11 23:02:25,255 - INFO - Loss will be calcuated upon denormalized data.
2023-05-11 23:02:25,255 - INFO - Start training ...
2023-05-11 23:02:25,255 - INFO - num_batches:319
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:05:07,117 - INFO - epoch complete!
2023-05-11 23:05:07,117 - INFO - validating now!
2023-05-11 23:05:30,841 - INFO - Epoch [0/100] train_loss: 35.6989, val_loss: 29.9975, lr: 0.010000, 185.59s
2023-05-11 23:05:30,842 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:05:59,992 - INFO - Evaluate result of 0 is {'MAE@12': 29.03169462834847, 'MAPE@12': inf, 'MSE@12': 1666.0766571035904, 'RMSE@12': 40.817602294887315, 'masked_MAE@12': 28.81840181060741, 'masked_MAPE@12': 0.371413028707885, 'masked_MSE@12': 1644.4394212865723, 'masked_RMSE@12': 40.55168826678579, 'R2@12': 0.9332646474091643, 'EVAR@12': 0.933627344560474}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:08:40,769 - INFO - epoch complete!
2023-05-11 23:08:40,770 - INFO - validating now!
2023-05-11 23:09:04,632 - INFO - Epoch [1/100] train_loss: 26.8990, val_loss: 26.2736, lr: 0.010000, 184.64s
2023-05-11 23:09:04,633 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:09:34,222 - INFO - Evaluate result of 1 is {'MAE@12': 25.159424801577003, 'MAPE@12': inf, 'MSE@12': 1452.3225341095974, 'RMSE@12': 38.10934969413146, 'masked_MAE@12': 25.21392177411599, 'masked_MAPE@12': 0.1820015572296386, 'masked_MSE@12': 1442.115391372249, 'masked_RMSE@12': 37.9751944217834, 'R2@12': 0.9418266524675317, 'EVAR@12': 0.9426803698325827}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:12:15,356 - INFO - epoch complete!
2023-05-11 23:12:15,356 - INFO - validating now!
2023-05-11 23:12:38,893 - INFO - Epoch [2/100] train_loss: 25.4328, val_loss: 24.9211, lr: 0.010000, 184.67s
2023-05-11 23:12:38,894 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:13:08,043 - INFO - Evaluate result of 2 is {'MAE@12': 23.97482161204547, 'MAPE@12': inf, 'MSE@12': 1368.1478678827712, 'RMSE@12': 36.98848290864024, 'masked_MAE@12': 23.951900861023454, 'masked_MAPE@12': 0.1831045584127555, 'masked_MSE@12': 1354.6068751869955, 'masked_RMSE@12': 36.804984379659714, 'R2@12': 0.9451983016686129, 'EVAR@12': 0.945665116253415}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:15:49,444 - INFO - epoch complete!
2023-05-11 23:15:49,445 - INFO - validating now!
2023-05-11 23:16:12,699 - INFO - Epoch [3/100] train_loss: 24.5802, val_loss: 27.8423, lr: 0.010000, 184.65s
2023-05-11 23:16:12,699 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:16:42,523 - INFO - Evaluate result of 3 is {'MAE@12': 26.964233232217264, 'MAPE@12': inf, 'MSE@12': 1616.2050282829164, 'RMSE@12': 40.20205253818412, 'masked_MAE@12': 26.894922828699514, 'masked_MAPE@12': 0.23613826269543217, 'masked_MSE@12': 1605.2995027440415, 'masked_RMSE@12': 40.06618902196766, 'R2@12': 0.9352622750209771, 'EVAR@12': 0.9390151352310637}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:19:24,391 - INFO - epoch complete!
2023-05-11 23:19:24,392 - INFO - validating now!
2023-05-11 23:19:47,755 - INFO - Epoch [4/100] train_loss: 24.0051, val_loss: 27.4038, lr: 0.010000, 185.23s
2023-05-11 23:19:47,756 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:20:17,987 - INFO - Evaluate result of 4 is {'MAE@12': 26.67297235494387, 'MAPE@12': inf, 'MSE@12': 1534.0416293236815, 'RMSE@12': 39.16684349451308, 'masked_MAE@12': 26.7807965879994, 'masked_MAPE@12': 0.1995537795977307, 'masked_MSE@12': 1523.0933883042699, 'masked_RMSE@12': 39.02682908339172, 'R2@12': 0.9385533621244591, 'EVAR@12': 0.9409422650300083}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:22:58,668 - INFO - epoch complete!
2023-05-11 23:22:58,668 - INFO - validating now!
2023-05-11 23:23:21,704 - INFO - Epoch [5/100] train_loss: 23.5994, val_loss: 23.7032, lr: 0.010000, 183.72s
2023-05-11 23:23:21,704 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:23:51,615 - INFO - Evaluate result of 5 is {'MAE@12': 23.027402156855306, 'MAPE@12': inf, 'MSE@12': 1246.1700782298449, 'RMSE@12': 35.301134234325175, 'masked_MAE@12': 23.000368511953617, 'masked_MAPE@12': 0.17993409288364492, 'masked_MSE@12': 1233.5423728177775, 'masked_RMSE@12': 35.121821889215504, 'R2@12': 0.9500841697743999, 'EVAR@12': 0.9508696353618814}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:26:31,867 - INFO - epoch complete!
2023-05-11 23:26:31,867 - INFO - validating now!
2023-05-11 23:26:54,945 - INFO - Epoch [6/100] train_loss: 22.9892, val_loss: 23.4424, lr: 0.010000, 183.33s
2023-05-11 23:26:54,945 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:27:24,419 - INFO - Evaluate result of 6 is {'MAE@12': 22.684103393746977, 'MAPE@12': inf, 'MSE@12': 1219.1752342639188, 'RMSE@12': 34.91668990989723, 'masked_MAE@12': 22.748917810504842, 'masked_MAPE@12': 0.1603851238833842, 'masked_MSE@12': 1205.7616438464192, 'masked_RMSE@12': 34.72407873286805, 'R2@12': 0.9511654588150449, 'EVAR@12': 0.9521601808781659}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:30:04,751 - INFO - epoch complete!
2023-05-11 23:30:04,752 - INFO - validating now!
2023-05-11 23:30:27,696 - INFO - Epoch [7/100] train_loss: 22.7546, val_loss: 24.7751, lr: 0.010000, 183.28s
2023-05-11 23:30:27,696 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:30:57,519 - INFO - Evaluate result of 7 is {'MAE@12': 24.413623729413352, 'MAPE@12': inf, 'MSE@12': 1298.1766688500825, 'RMSE@12': 36.0302188287843, 'masked_MAE@12': 24.303518189445146, 'masked_MAPE@12': 0.25304922166429333, 'masked_MSE@12': 1280.74827119408, 'masked_RMSE@12': 35.787543519974655, 'R2@12': 0.9480010254320967, 'EVAR@12': 0.948778877360586}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:33:38,105 - INFO - epoch complete!
2023-05-11 23:33:38,106 - INFO - validating now!
2023-05-11 23:34:01,042 - INFO - Epoch [8/100] train_loss: 22.6036, val_loss: 22.6032, lr: 0.010000, 183.52s
2023-05-11 23:34:01,043 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:34:30,907 - INFO - Evaluate result of 8 is {'MAE@12': 21.902796800964275, 'MAPE@12': inf, 'MSE@12': 1163.7600983133595, 'RMSE@12': 34.113928215808855, 'masked_MAE@12': 21.90190385160249, 'masked_MAPE@12': 0.15975782793265567, 'masked_MSE@12': 1143.810081508628, 'masked_RMSE@12': 33.820261405090115, 'R2@12': 0.9533851337746346, 'EVAR@12': 0.9535631655951656}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:37:11,234 - INFO - epoch complete!
2023-05-11 23:37:11,234 - INFO - validating now!
2023-05-11 23:37:34,154 - INFO - Epoch [9/100] train_loss: 22.4236, val_loss: 22.9332, lr: 0.010000, 183.25s
2023-05-11 23:37:34,155 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:38:03,693 - INFO - Evaluate result of 9 is {'MAE@12': 22.437365009705022, 'MAPE@12': inf, 'MSE@12': 1205.4298296834577, 'RMSE@12': 34.719300535630865, 'masked_MAE@12': 22.377234986136877, 'masked_MAPE@12': 0.16285679853170487, 'masked_MSE@12': 1177.7301620317892, 'masked_RMSE@12': 34.318073402098044, 'R2@12': 0.9517160363753688, 'EVAR@12': 0.952586860088969}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:40:44,533 - INFO - epoch complete!
2023-05-11 23:40:44,534 - INFO - validating now!
2023-05-11 23:41:07,427 - INFO - Epoch [10/100] train_loss: 22.3484, val_loss: 22.1719, lr: 0.010000, 183.73s
2023-05-11 23:41:07,428 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:41:37,438 - INFO - Evaluate result of 10 is {'MAE@12': 21.76905530572851, 'MAPE@12': inf, 'MSE@12': 1165.2504312292006, 'RMSE@12': 34.13576469378122, 'masked_MAE@12': 21.721135817834334, 'masked_MAPE@12': 0.15460900394701174, 'masked_MSE@12': 1130.040228504636, 'masked_RMSE@12': 33.6160709855366, 'R2@12': 0.9533254379063849, 'EVAR@12': 0.9539125891273144}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:44:18,001 - INFO - epoch complete!
2023-05-11 23:44:18,001 - INFO - validating now!
2023-05-11 23:44:40,837 - INFO - Epoch [11/100] train_loss: 21.8952, val_loss: 23.0606, lr: 0.010000, 183.40s
2023-05-11 23:44:40,838 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:45:10,329 - INFO - Evaluate result of 11 is {'MAE@12': 22.5207003575756, 'MAPE@12': inf, 'MSE@12': 1227.4549457921225, 'RMSE@12': 35.03505310103186, 'masked_MAE@12': 22.464247396038786, 'masked_MAPE@12': 0.1646531206584939, 'masked_MSE@12': 1189.6956872016408, 'masked_RMSE@12': 34.49196554564035, 'R2@12': 0.9508338117291626, 'EVAR@12': 0.9509931792706346}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:47:51,124 - INFO - epoch complete!
2023-05-11 23:47:51,125 - INFO - validating now!
2023-05-11 23:48:14,086 - INFO - Epoch [12/100] train_loss: 21.9244, val_loss: 21.9450, lr: 0.010000, 183.76s
2023-05-11 23:48:14,087 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:48:43,441 - INFO - Evaluate result of 12 is {'MAE@12': 21.535885144190765, 'MAPE@12': inf, 'MSE@12': 1165.8056220809144, 'RMSE@12': 34.14389582459673, 'masked_MAE@12': 21.382700816725436, 'masked_MAPE@12': 0.16716988114382333, 'masked_MSE@12': 1100.7818958168452, 'masked_RMSE@12': 33.17803333256577, 'R2@12': 0.9533031995195218, 'EVAR@12': 0.953462174128429}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:51:24,381 - INFO - epoch complete!
2023-05-11 23:51:24,381 - INFO - validating now!
2023-05-11 23:51:47,400 - INFO - Epoch [13/100] train_loss: 21.5679, val_loss: 22.0987, lr: 0.010000, 183.96s
2023-05-11 23:51:47,401 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:52:16,798 - INFO - Evaluate result of 13 is {'MAE@12': 21.720331882259504, 'MAPE@12': inf, 'MSE@12': 1151.3030219822376, 'RMSE@12': 33.93085648760192, 'masked_MAE@12': 21.6324902904713, 'masked_MAPE@12': 0.16931934195304404, 'masked_MSE@12': 1105.5880489491549, 'masked_RMSE@12': 33.25038419250453, 'R2@12': 0.9538841068426889, 'EVAR@12': 0.9539513862200835}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:54:57,940 - INFO - epoch complete!
2023-05-11 23:54:57,941 - INFO - validating now!
2023-05-11 23:55:20,922 - INFO - Epoch [14/100] train_loss: 21.4631, val_loss: 23.0965, lr: 0.010000, 184.12s
2023-05-11 23:55:20,922 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:55:50,330 - INFO - Evaluate result of 14 is {'MAE@12': 22.85490092145595, 'MAPE@12': inf, 'MSE@12': 1172.1673510595404, 'RMSE@12': 34.236929638323886, 'masked_MAE@12': 22.682124735335663, 'masked_MAPE@12': 0.23407709215872818, 'masked_MSE@12': 1133.2067399230614, 'masked_RMSE@12': 33.66313621638752, 'R2@12': 0.9530483779753475, 'EVAR@12': 0.9531182150402635}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-11 23:58:30,974 - INFO - epoch complete!
2023-05-11 23:58:30,975 - INFO - validating now!
2023-05-11 23:58:53,876 - INFO - Epoch [15/100] train_loss: 21.5333, val_loss: 22.0669, lr: 0.010000, 183.54s
2023-05-11 23:58:53,876 - INFO - Extensive metrics on test dataset (for reference)
2023-05-11 23:59:23,163 - INFO - Evaluate result of 15 is {'MAE@12': 21.966088310614087, 'MAPE@12': inf, 'MSE@12': 1166.078849300828, 'RMSE@12': 34.147896703908835, 'masked_MAE@12': 21.759410084011584, 'masked_MAPE@12': 0.19471423364792562, 'masked_MSE@12': 1098.3065183944693, 'masked_RMSE@12': 33.140707874070365, 'R2@12': 0.953292255296289, 'EVAR@12': 0.9533820771024554}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:02:03,522 - INFO - epoch complete!
2023-05-12 00:02:03,523 - INFO - validating now!
2023-05-12 00:02:26,343 - INFO - Epoch [16/100] train_loss: 21.2107, val_loss: 21.6066, lr: 0.010000, 183.18s
2023-05-12 00:02:26,343 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:02:56,141 - INFO - Evaluate result of 16 is {'MAE@12': 21.393865355153387, 'MAPE@12': inf, 'MSE@12': 1125.106629757814, 'RMSE@12': 33.542609167412934, 'masked_MAE@12': 21.309331295458133, 'masked_MAPE@12': 0.1589981041367936, 'masked_MSE@12': 1080.489847969363, 'masked_RMSE@12': 32.87080540493894, 'R2@12': 0.9549334135863197, 'EVAR@12': 0.955162848163483}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:05:36,597 - INFO - epoch complete!
2023-05-12 00:05:36,598 - INFO - validating now!
2023-05-12 00:05:59,490 - INFO - Epoch [17/100] train_loss: 21.2888, val_loss: 21.9084, lr: 0.010000, 183.35s
2023-05-12 00:05:59,491 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:06:29,145 - INFO - Evaluate result of 17 is {'MAE@12': 21.7174848810115, 'MAPE@12': inf, 'MSE@12': 1150.7715198421988, 'RMSE@12': 33.92302344783258, 'masked_MAE@12': 21.651764516359716, 'masked_MAPE@12': 0.15398863190462014, 'masked_MSE@12': 1112.0449321500694, 'masked_RMSE@12': 33.34733770708045, 'R2@12': 0.9539053963689342, 'EVAR@12': 0.9552593301636199}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:09:09,328 - INFO - epoch complete!
2023-05-12 00:09:09,329 - INFO - validating now!
2023-05-12 00:09:32,202 - INFO - Epoch [18/100] train_loss: 21.2315, val_loss: 21.9843, lr: 0.010000, 183.06s
2023-05-12 00:09:32,202 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:10:01,499 - INFO - Evaluate result of 18 is {'MAE@12': 21.600583150723438, 'MAPE@12': inf, 'MSE@12': 1128.3427275539207, 'RMSE@12': 33.5908131421959, 'masked_MAE@12': 21.553706305680965, 'masked_MAPE@12': 0.156883751078448, 'masked_MSE@12': 1077.847643019071, 'masked_RMSE@12': 32.8305900498159, 'R2@12': 0.954803790422511, 'EVAR@12': 0.9548471532081003}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:12:41,676 - INFO - epoch complete!
2023-05-12 00:12:41,677 - INFO - validating now!
2023-05-12 00:13:04,582 - INFO - Epoch [19/100] train_loss: 21.1044, val_loss: 21.7251, lr: 0.010000, 183.08s
2023-05-12 00:13:04,583 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:13:33,953 - INFO - Evaluate result of 19 is {'MAE@12': 21.434740074367866, 'MAPE@12': inf, 'MSE@12': 1131.3969716450383, 'RMSE@12': 33.636244909993124, 'masked_MAE@12': 21.36292398484146, 'masked_MAPE@12': 0.14983639834848791, 'masked_MSE@12': 1079.7189372797648, 'masked_RMSE@12': 32.859076938948924, 'R2@12': 0.9546814514800318, 'EVAR@12': 0.9548911067490168}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:16:14,287 - INFO - epoch complete!
2023-05-12 00:16:14,288 - INFO - validating now!
2023-05-12 00:16:37,395 - INFO - Epoch [20/100] train_loss: 21.1101, val_loss: 21.4778, lr: 0.010000, 183.44s
2023-05-12 00:16:37,395 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:17:06,876 - INFO - Evaluate result of 20 is {'MAE@12': 21.15919428245404, 'MAPE@12': inf, 'MSE@12': 1113.4687013922428, 'RMSE@12': 33.36867844839293, 'masked_MAE@12': 21.11065986188436, 'masked_MAPE@12': 0.14175903990886143, 'masked_MSE@12': 1064.777333150251, 'masked_RMSE@12': 32.63092602348654, 'R2@12': 0.955399575362005, 'EVAR@12': 0.9559527499148034}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:19:46,628 - INFO - epoch complete!
2023-05-12 00:19:46,629 - INFO - validating now!
2023-05-12 00:20:09,795 - INFO - Epoch [21/100] train_loss: 20.7347, val_loss: 21.8859, lr: 0.010000, 182.92s
2023-05-12 00:20:09,796 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:20:41,359 - INFO - Evaluate result of 21 is {'MAE@12': 21.765094830278127, 'MAPE@12': inf, 'MSE@12': 1118.0548262641553, 'RMSE@12': 33.4373268408848, 'masked_MAE@12': 21.698432101415147, 'masked_MAPE@12': 0.19030423825236287, 'masked_MSE@12': 1090.6985804188052, 'masked_RMSE@12': 33.02572603923804, 'R2@12': 0.9552158763352839, 'EVAR@12': 0.9553081862281864}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:23:20,941 - INFO - epoch complete!
2023-05-12 00:23:20,941 - INFO - validating now!
2023-05-12 00:23:44,163 - INFO - Epoch [22/100] train_loss: 20.7448, val_loss: 20.8942, lr: 0.010000, 182.80s
2023-05-12 00:23:44,163 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:24:16,249 - INFO - Evaluate result of 22 is {'MAE@12': 20.734520621970084, 'MAPE@12': inf, 'MSE@12': 1091.3434588130642, 'RMSE@12': 33.03548787006277, 'masked_MAE@12': 20.60971128487866, 'masked_MAPE@12': 0.14618705881859453, 'masked_MSE@12': 1034.140760222738, 'masked_RMSE@12': 32.15805902449242, 'R2@12': 0.9562858106131764, 'EVAR@12': 0.9563362247906904}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:26:55,733 - INFO - epoch complete!
2023-05-12 00:26:55,734 - INFO - validating now!
2023-05-12 00:27:18,782 - INFO - Epoch [23/100] train_loss: 20.7068, val_loss: 22.2752, lr: 0.010000, 182.53s
2023-05-12 00:27:18,783 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:27:50,068 - INFO - Evaluate result of 23 is {'MAE@12': 22.215359051612108, 'MAPE@12': inf, 'MSE@12': 1172.6240774857106, 'RMSE@12': 34.243599073194844, 'masked_MAE@12': 22.03538480506787, 'masked_MAPE@12': 0.20188888718486783, 'masked_MSE@12': 1119.9760075246616, 'masked_RMSE@12': 33.466042603281636, 'R2@12': 0.9530300836195877, 'EVAR@12': 0.9534130857834083}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:30:29,368 - INFO - epoch complete!
2023-05-12 00:30:29,369 - INFO - validating now!
2023-05-12 00:30:52,643 - INFO - Epoch [24/100] train_loss: 20.6553, val_loss: 23.5285, lr: 0.010000, 182.57s
2023-05-12 00:30:52,643 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:31:23,441 - INFO - Evaluate result of 24 is {'MAE@12': 23.477620937468195, 'MAPE@12': inf, 'MSE@12': 1209.408961413042, 'RMSE@12': 34.776557641794305, 'masked_MAE@12': 23.177100144435272, 'masked_MAPE@12': 0.2573935052213948, 'masked_MSE@12': 1124.8892148846664, 'masked_RMSE@12': 33.539368134845155, 'R2@12': 0.9515566506965366, 'EVAR@12': 0.9522112074865565}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:34:02,463 - INFO - epoch complete!
2023-05-12 00:34:02,463 - INFO - validating now!
2023-05-12 00:34:25,638 - INFO - Epoch [25/100] train_loss: 20.5625, val_loss: 21.6816, lr: 0.010000, 182.20s
2023-05-12 00:34:25,639 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:34:56,075 - INFO - Evaluate result of 25 is {'MAE@12': 21.69500557349139, 'MAPE@12': inf, 'MSE@12': 1125.8777956604438, 'RMSE@12': 33.554102516092485, 'masked_MAE@12': 21.481493466467235, 'masked_MAPE@12': 0.19844547426393627, 'masked_MSE@12': 1065.7618917456414, 'masked_RMSE@12': 32.646008818010834, 'R2@12': 0.954902524234261, 'EVAR@12': 0.9549090743300779}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:37:35,603 - INFO - epoch complete!
2023-05-12 00:37:35,604 - INFO - validating now!
2023-05-12 00:37:58,742 - INFO - Epoch [26/100] train_loss: 20.3901, val_loss: 21.0340, lr: 0.010000, 182.67s
2023-05-12 00:37:58,742 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:38:28,809 - INFO - Evaluate result of 26 is {'MAE@12': 20.9741798499082, 'MAPE@12': inf, 'MSE@12': 1119.3119448625914, 'RMSE@12': 33.45611969225647, 'masked_MAE@12': 20.856272372072812, 'masked_MAPE@12': 0.14605059528692127, 'masked_MSE@12': 1042.223145324675, 'masked_RMSE@12': 32.28348099763523, 'R2@12': 0.9551655219577962, 'EVAR@12': 0.9554760939509402}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:41:08,385 - INFO - epoch complete!
2023-05-12 00:41:08,386 - INFO - validating now!
2023-05-12 00:41:32,012 - INFO - Epoch [27/100] train_loss: 20.6230, val_loss: 21.3534, lr: 0.010000, 183.20s
2023-05-12 00:41:32,013 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:42:01,649 - INFO - Evaluate result of 27 is {'MAE@12': 21.080647260295137, 'MAPE@12': inf, 'MSE@12': 1082.3993089134533, 'RMSE@12': 32.899837521079846, 'masked_MAE@12': 21.04185148442443, 'masked_MAPE@12': 0.1472464424186011, 'masked_MSE@12': 1042.2121213869411, 'masked_RMSE@12': 32.28331026067403, 'R2@12': 0.9566440720380821, 'EVAR@12': 0.9570391842890946}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:44:41,537 - INFO - epoch complete!
2023-05-12 00:44:41,537 - INFO - validating now!
2023-05-12 00:45:05,519 - INFO - Epoch [28/100] train_loss: 20.6512, val_loss: 21.3408, lr: 0.010000, 183.87s
2023-05-12 00:45:05,520 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:45:34,326 - INFO - Evaluate result of 28 is {'MAE@12': 21.3017089589153, 'MAPE@12': inf, 'MSE@12': 1204.6816435952107, 'RMSE@12': 34.70852407687787, 'masked_MAE@12': 21.064959349474613, 'masked_MAPE@12': 0.14684942395606684, 'masked_MSE@12': 1065.6692925083025, 'masked_RMSE@12': 32.6445905550721, 'R2@12': 0.9517460052619684, 'EVAR@12': 0.9519734938808111}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:48:13,864 - INFO - epoch complete!
2023-05-12 00:48:13,864 - INFO - validating now!
2023-05-12 00:48:37,993 - INFO - Epoch [29/100] train_loss: 20.4322, val_loss: 21.6717, lr: 0.010000, 183.67s
2023-05-12 00:48:37,994 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:49:07,145 - INFO - Evaluate result of 29 is {'MAE@12': 21.309869202955607, 'MAPE@12': inf, 'MSE@12': 1144.7935190040619, 'RMSE@12': 33.83479745770708, 'masked_MAE@12': 21.130155661652346, 'masked_MAPE@12': 0.15479160590220856, 'masked_MSE@12': 1064.9540849015707, 'masked_RMSE@12': 32.63363425825525, 'R2@12': 0.9541448475322527, 'EVAR@12': 0.9552017728465168}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:51:46,609 - INFO - epoch complete!
2023-05-12 00:51:46,610 - INFO - validating now!
2023-05-12 00:52:10,189 - INFO - Epoch [30/100] train_loss: 20.3778, val_loss: 20.8519, lr: 0.010000, 183.04s
2023-05-12 00:52:10,189 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:52:39,159 - INFO - Evaluate result of 30 is {'MAE@12': 20.873427895278525, 'MAPE@12': inf, 'MSE@12': 1121.6316913683618, 'RMSE@12': 33.49077024149134, 'masked_MAE@12': 20.671327549544266, 'masked_MAPE@12': 0.15046912585877603, 'masked_MSE@12': 1032.5302239276105, 'masked_RMSE@12': 32.13300832364767, 'R2@12': 0.9550726036035753, 'EVAR@12': 0.9550807946713503}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:55:18,965 - INFO - epoch complete!
2023-05-12 00:55:18,966 - INFO - validating now!
2023-05-12 00:55:42,458 - INFO - Epoch [31/100] train_loss: 20.7091, val_loss: 22.1350, lr: 0.010000, 183.30s
2023-05-12 00:55:42,458 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:56:11,762 - INFO - Evaluate result of 31 is {'MAE@12': 21.69916572875063, 'MAPE@12': inf, 'MSE@12': 1168.8179749823457, 'RMSE@12': 34.18797997809092, 'masked_MAE@12': 21.59343279783221, 'masked_MAPE@12': 0.1582241910130239, 'masked_MSE@12': 1088.7760424316577, 'masked_RMSE@12': 32.996606529030494, 'R2@12': 0.9531825385450414, 'EVAR@12': 0.9532105813737012}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 00:58:51,674 - INFO - epoch complete!
2023-05-12 00:58:51,675 - INFO - validating now!
2023-05-12 00:59:14,588 - INFO - Epoch [32/100] train_loss: 20.5329, val_loss: 20.8900, lr: 0.010000, 182.82s
2023-05-12 00:59:14,589 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 00:59:44,150 - INFO - Evaluate result of 32 is {'MAE@12': 20.943522194471214, 'MAPE@12': inf, 'MSE@12': 1157.841911721637, 'RMSE@12': 34.0270761559326, 'masked_MAE@12': 20.675344387239413, 'masked_MAPE@12': 0.14931224992111894, 'masked_MSE@12': 1035.6415373848906, 'masked_RMSE@12': 32.1813849513176, 'R2@12': 0.9536221890549024, 'EVAR@12': 0.9537049274645736}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:02:24,086 - INFO - epoch complete!
2023-05-12 01:02:24,087 - INFO - validating now!
2023-05-12 01:02:46,838 - INFO - Epoch [33/100] train_loss: 20.3315, val_loss: 20.9708, lr: 0.010000, 182.69s
2023-05-12 01:02:46,839 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:03:16,059 - INFO - Evaluate result of 33 is {'MAE@12': 21.042063966199, 'MAPE@12': inf, 'MSE@12': 1108.0900993529478, 'RMSE@12': 33.28798731303753, 'masked_MAE@12': 20.818755515186243, 'masked_MAPE@12': 0.17063007875637679, 'masked_MSE@12': 1033.4200353877006, 'masked_RMSE@12': 32.14685109598918, 'R2@12': 0.9556150173718355, 'EVAR@12': 0.9556209622595626}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:05:56,269 - INFO - epoch complete!
2023-05-12 01:05:56,269 - INFO - validating now!
2023-05-12 01:06:19,091 - INFO - Epoch [34/100] train_loss: 20.5962, val_loss: 21.0629, lr: 0.010000, 183.03s
2023-05-12 01:06:19,091 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:06:48,162 - INFO - Evaluate result of 34 is {'MAE@12': 20.924720926919573, 'MAPE@12': inf, 'MSE@12': 1132.853898847309, 'RMSE@12': 33.65789504480797, 'masked_MAE@12': 20.70702611456176, 'masked_MAPE@12': 0.1563007032214807, 'masked_MSE@12': 1041.6051251158608, 'masked_RMSE@12': 32.273907806707584, 'R2@12': 0.954623093690714, 'EVAR@12': 0.9546451113542016}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:09:28,110 - INFO - epoch complete!
2023-05-12 01:09:28,110 - INFO - validating now!
2023-05-12 01:09:50,955 - INFO - Epoch [35/100] train_loss: 20.6408, val_loss: 21.2779, lr: 0.010000, 182.79s
2023-05-12 01:09:50,956 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:10:20,025 - INFO - Evaluate result of 35 is {'MAE@12': 21.152994016296784, 'MAPE@12': inf, 'MSE@12': 1154.0071335211487, 'RMSE@12': 33.97068049835253, 'masked_MAE@12': 20.970301913599513, 'masked_MAPE@12': 0.15143253904497284, 'masked_MSE@12': 1045.8716319630512, 'masked_RMSE@12': 32.33993865119492, 'R2@12': 0.9537757925966277, 'EVAR@12': 0.9538919482528639}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:12:59,937 - INFO - epoch complete!
2023-05-12 01:12:59,938 - INFO - validating now!
2023-05-12 01:13:22,576 - INFO - Epoch [36/100] train_loss: 20.3802, val_loss: 20.8727, lr: 0.010000, 182.55s
2023-05-12 01:13:22,577 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:13:51,971 - INFO - Evaluate result of 36 is {'MAE@12': 20.680888011934137, 'MAPE@12': inf, 'MSE@12': 1092.3398145710019, 'RMSE@12': 33.050564512138095, 'masked_MAE@12': 20.5347797641933, 'masked_MAPE@12': 0.14781515844326062, 'masked_MSE@12': 1022.329521963375, 'masked_RMSE@12': 31.973888127085434, 'R2@12': 0.9562459011933258, 'EVAR@12': 0.956351629965232}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:16:32,330 - INFO - epoch complete!
2023-05-12 01:16:32,330 - INFO - validating now!
2023-05-12 01:16:55,130 - INFO - Epoch [37/100] train_loss: 20.4134, val_loss: 20.7878, lr: 0.010000, 183.16s
2023-05-12 01:16:55,131 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:17:24,268 - INFO - Evaluate result of 37 is {'MAE@12': 20.903046214626396, 'MAPE@12': inf, 'MSE@12': 1118.6679870056917, 'RMSE@12': 33.44649439037956, 'masked_MAE@12': 20.743278805392375, 'masked_MAPE@12': 0.1489313462625027, 'masked_MSE@12': 1043.7125676846786, 'masked_RMSE@12': 32.30654063320117, 'R2@12': 0.9551913159417948, 'EVAR@12': 0.9556224714391575}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:20:04,651 - INFO - epoch complete!
2023-05-12 01:20:04,652 - INFO - validating now!
2023-05-12 01:20:27,477 - INFO - Epoch [38/100] train_loss: 20.2458, val_loss: 21.0973, lr: 0.010000, 183.21s
2023-05-12 01:20:27,478 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:20:56,980 - INFO - Evaluate result of 38 is {'MAE@12': 21.063770200570385, 'MAPE@12': inf, 'MSE@12': 1093.2020563353824, 'RMSE@12': 33.06360622097025, 'masked_MAE@12': 20.855233071385364, 'masked_MAPE@12': 0.17718755131247724, 'masked_MSE@12': 1023.2719780012849, 'masked_RMSE@12': 31.988622633700327, 'R2@12': 0.9562113637619782, 'EVAR@12': 0.9562214789478802}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:23:37,361 - INFO - epoch complete!
2023-05-12 01:23:37,361 - INFO - validating now!
2023-05-12 01:24:00,280 - INFO - Epoch [39/100] train_loss: 20.2200, val_loss: 22.7365, lr: 0.010000, 183.30s
2023-05-12 01:24:00,280 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:24:29,265 - INFO - Evaluate result of 39 is {'MAE@12': 22.96954010389967, 'MAPE@12': inf, 'MSE@12': 1229.4643044195311, 'RMSE@12': 35.06371777806129, 'masked_MAE@12': 22.710550967011667, 'masked_MAPE@12': 0.19969670748198434, 'masked_MSE@12': 1141.2258855088983, 'masked_RMSE@12': 33.78203495215909, 'R2@12': 0.9507533260828931, 'EVAR@12': 0.9521552971756334}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:27:09,560 - INFO - epoch complete!
2023-05-12 01:27:09,560 - INFO - validating now!
2023-05-12 01:27:33,732 - INFO - Epoch [40/100] train_loss: 20.7299, val_loss: 21.7148, lr: 0.010000, 184.47s
2023-05-12 01:27:33,733 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:28:05,212 - INFO - Evaluate result of 40 is {'MAE@12': 21.825988000885935, 'MAPE@12': inf, 'MSE@12': 1169.1746364576031, 'RMSE@12': 34.19319576257246, 'masked_MAE@12': 21.5790361381346, 'masked_MAPE@12': 0.1826212256033115, 'masked_MSE@12': 1080.7703894864835, 'masked_RMSE@12': 32.87507246359289, 'R2@12': 0.9531682523300553, 'EVAR@12': 0.9538448526129278}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:30:46,098 - INFO - epoch complete!
2023-05-12 01:30:46,098 - INFO - validating now!
2023-05-12 01:31:09,115 - INFO - Epoch [41/100] train_loss: 20.3085, val_loss: 22.8209, lr: 0.010000, 183.90s
2023-05-12 01:31:09,115 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:31:38,573 - INFO - Evaluate result of 41 is {'MAE@12': 23.192216752087464, 'MAPE@12': inf, 'MSE@12': 1278.4124621667033, 'RMSE@12': 35.75489424074281, 'masked_MAE@12': 22.853447819711146, 'masked_MAPE@12': 0.2062558833024303, 'masked_MSE@12': 1155.1375992424196, 'masked_RMSE@12': 33.98731526970643, 'R2@12': 0.9487926884663693, 'EVAR@12': 0.9499159426726751}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:34:19,192 - INFO - epoch complete!
2023-05-12 01:34:19,192 - INFO - validating now!
2023-05-12 01:34:42,088 - INFO - Epoch [42/100] train_loss: 20.2589, val_loss: 21.0089, lr: 0.010000, 183.51s
2023-05-12 01:34:42,088 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:35:11,638 - INFO - Evaluate result of 42 is {'MAE@12': 20.843588684274376, 'MAPE@12': inf, 'MSE@12': 1108.3131898305128, 'RMSE@12': 33.291338060079724, 'masked_MAE@12': 20.706135355518036, 'masked_MAPE@12': 0.14659608499599727, 'masked_MSE@12': 1037.1678113656014, 'masked_RMSE@12': 32.20508983632248, 'R2@12': 0.9556060813954407, 'EVAR@12': 0.9559045305702227}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:37:52,378 - INFO - epoch complete!
2023-05-12 01:37:52,379 - INFO - validating now!
2023-05-12 01:38:15,301 - INFO - Epoch [43/100] train_loss: 20.5255, val_loss: 21.4852, lr: 0.010000, 183.66s
2023-05-12 01:38:15,301 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:38:44,757 - INFO - Evaluate result of 43 is {'MAE@12': 21.50520160877996, 'MAPE@12': inf, 'MSE@12': 1166.5863346016586, 'RMSE@12': 34.15532659193378, 'masked_MAE@12': 21.19140672118337, 'masked_MAPE@12': 0.18901566406857453, 'masked_MSE@12': 1048.9670044796746, 'masked_RMSE@12': 32.387760102848645, 'R2@12': 0.9532719277739381, 'EVAR@12': 0.9533010947498592}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:41:25,577 - INFO - epoch complete!
2023-05-12 01:41:25,577 - INFO - validating now!
2023-05-12 01:41:48,554 - INFO - Epoch [44/100] train_loss: 20.5933, val_loss: 21.2305, lr: 0.010000, 183.79s
2023-05-12 01:41:48,554 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:42:17,852 - INFO - Evaluate result of 44 is {'MAE@12': 21.34483938177647, 'MAPE@12': inf, 'MSE@12': 1145.4578422260627, 'RMSE@12': 33.84461319362452, 'masked_MAE@12': 21.162424316985476, 'masked_MAPE@12': 0.1584494148000949, 'masked_MSE@12': 1069.5035186209532, 'masked_RMSE@12': 32.703264647752725, 'R2@12': 0.9541182378055842, 'EVAR@12': 0.9545492390850694}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:44:58,628 - INFO - epoch complete!
2023-05-12 01:44:58,629 - INFO - validating now!
2023-05-12 01:45:21,734 - INFO - Epoch [45/100] train_loss: 20.4350, val_loss: 21.1624, lr: 0.010000, 183.88s
2023-05-12 01:45:21,734 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:45:51,487 - INFO - Evaluate result of 45 is {'MAE@12': 21.10269134346431, 'MAPE@12': inf, 'MSE@12': 1147.4308372329808, 'RMSE@12': 33.87374849692577, 'masked_MAE@12': 20.91481814751905, 'masked_MAPE@12': 0.1469536661182409, 'masked_MSE@12': 1040.1572542568101, 'masked_RMSE@12': 32.25146902478723, 'R2@12': 0.9540392087183659, 'EVAR@12': 0.9542163033256689}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:48:32,337 - INFO - epoch complete!
2023-05-12 01:48:32,337 - INFO - validating now!
2023-05-12 01:48:55,265 - INFO - Epoch [46/100] train_loss: 20.5785, val_loss: 21.4247, lr: 0.010000, 183.78s
2023-05-12 01:48:55,265 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:49:24,707 - INFO - Evaluate result of 46 is {'MAE@12': 21.052339370807687, 'MAPE@12': inf, 'MSE@12': 1096.5008677833086, 'RMSE@12': 33.1134544827825, 'masked_MAE@12': 20.99689627984519, 'masked_MAPE@12': 0.14936810351929533, 'masked_MSE@12': 1052.9024013851963, 'masked_RMSE@12': 32.4484576118064, 'R2@12': 0.9560792285783002, 'EVAR@12': 0.9560908901367371}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:52:05,679 - INFO - epoch complete!
2023-05-12 01:52:05,680 - INFO - validating now!
2023-05-12 01:52:28,835 - INFO - Epoch [47/100] train_loss: 20.5509, val_loss: 21.0101, lr: 0.010000, 184.13s
2023-05-12 01:52:28,835 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:52:58,874 - INFO - Evaluate result of 47 is {'MAE@12': 20.998253890421775, 'MAPE@12': inf, 'MSE@12': 1134.1291673966468, 'RMSE@12': 33.676834284069024, 'masked_MAE@12': 20.800914796566857, 'masked_MAPE@12': 0.15124522286410422, 'masked_MSE@12': 1046.8341132082185, 'masked_RMSE@12': 32.35481591986297, 'R2@12': 0.9545720123098391, 'EVAR@12': 0.954809787409296}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:55:40,183 - INFO - epoch complete!
2023-05-12 01:55:40,184 - INFO - validating now!
2023-05-12 01:56:03,299 - INFO - Epoch [48/100] train_loss: 20.8726, val_loss: 21.5100, lr: 0.010000, 184.42s
2023-05-12 01:56:03,300 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 01:56:33,323 - INFO - Evaluate result of 48 is {'MAE@12': 21.58941066876462, 'MAPE@12': inf, 'MSE@12': 1181.8213556818519, 'RMSE@12': 34.377628709407105, 'masked_MAE@12': 21.306069478549283, 'masked_MAPE@12': 0.16791158970807724, 'masked_MSE@12': 1066.9048085729933, 'masked_RMSE@12': 32.66350882212432, 'R2@12': 0.9526616830416921, 'EVAR@12': 0.9530965937939776}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 01:59:14,331 - INFO - epoch complete!
2023-05-12 01:59:14,331 - INFO - validating now!
2023-05-12 01:59:37,398 - INFO - Epoch [49/100] train_loss: 20.6856, val_loss: 20.8066, lr: 0.010000, 184.07s
2023-05-12 01:59:37,398 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:00:07,403 - INFO - Evaluate result of 49 is {'MAE@12': 20.71233865454932, 'MAPE@12': inf, 'MSE@12': 1112.4169010825067, 'RMSE@12': 33.35291443161312, 'masked_MAE@12': 20.50427603790303, 'masked_MAPE@12': 0.15146744813358182, 'masked_MSE@12': 1023.477993512381, 'masked_RMSE@12': 31.991842608896114, 'R2@12': 0.9554417056350786, 'EVAR@12': 0.9554604687625644}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:02:48,113 - INFO - epoch complete!
2023-05-12 02:02:48,113 - INFO - validating now!
2023-05-12 02:03:11,355 - INFO - Epoch [50/100] train_loss: 20.5625, val_loss: 20.9309, lr: 0.010000, 183.95s
2023-05-12 02:03:11,355 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:03:41,420 - INFO - Evaluate result of 50 is {'MAE@12': 20.951150106987097, 'MAPE@12': inf, 'MSE@12': 1148.3520354776538, 'RMSE@12': 33.887343293295416, 'masked_MAE@12': 20.71848845530798, 'masked_MAPE@12': 0.15384660901798136, 'masked_MSE@12': 1040.7036596811345, 'masked_RMSE@12': 32.259938928664056, 'R2@12': 0.9540023097621251, 'EVAR@12': 0.954007222237441}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:06:22,559 - INFO - epoch complete!
2023-05-12 02:06:22,560 - INFO - validating now!
2023-05-12 02:06:45,834 - INFO - Epoch [51/100] train_loss: 20.4862, val_loss: 20.6834, lr: 0.010000, 184.41s
2023-05-12 02:06:45,834 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:07:17,470 - INFO - Evaluate result of 51 is {'MAE@12': 20.572685332645534, 'MAPE@12': inf, 'MSE@12': 1101.0123142425393, 'RMSE@12': 33.181505605420305, 'masked_MAE@12': 20.398727778688766, 'masked_MAPE@12': 0.14537037492558208, 'masked_MSE@12': 1016.2204193529149, 'masked_RMSE@12': 31.878212298573377, 'R2@12': 0.9558985208246277, 'EVAR@12': 0.955898613992429}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:09:58,210 - INFO - epoch complete!
2023-05-12 02:09:58,210 - INFO - validating now!
2023-05-12 02:10:21,506 - INFO - Epoch [52/100] train_loss: 20.4706, val_loss: 21.4031, lr: 0.010000, 184.04s
2023-05-12 02:10:21,507 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:10:54,157 - INFO - Evaluate result of 52 is {'MAE@12': 21.19411014675517, 'MAPE@12': inf, 'MSE@12': 1160.33994373251, 'RMSE@12': 34.06376291211102, 'masked_MAE@12': 21.000245412554584, 'masked_MAPE@12': 0.1474567316907097, 'masked_MSE@12': 1052.1597988331027, 'masked_RMSE@12': 32.43701279145635, 'R2@12': 0.9535221294049948, 'EVAR@12': 0.9536159958091753}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:13:34,301 - INFO - epoch complete!
2023-05-12 02:13:34,301 - INFO - validating now!
2023-05-12 02:13:57,762 - INFO - Epoch [53/100] train_loss: 20.5002, val_loss: 20.8411, lr: 0.010000, 183.60s
2023-05-12 02:13:57,763 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:14:29,294 - INFO - Evaluate result of 53 is {'MAE@12': 21.02942738555551, 'MAPE@12': inf, 'MSE@12': 1210.5826481564118, 'RMSE@12': 34.79342823230289, 'masked_MAE@12': 20.698296471725698, 'masked_MAPE@12': 0.14699993486003907, 'masked_MSE@12': 1043.043764816466, 'masked_RMSE@12': 32.29618808491903, 'R2@12': 0.9515096382146583, 'EVAR@12': 0.9515394868831047}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:17:09,649 - INFO - epoch complete!
2023-05-12 02:17:09,649 - INFO - validating now!
2023-05-12 02:17:33,124 - INFO - Epoch [54/100] train_loss: 20.2245, val_loss: 21.0736, lr: 0.010000, 183.83s
2023-05-12 02:17:33,124 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:18:03,950 - INFO - Evaluate result of 54 is {'MAE@12': 21.22118056238957, 'MAPE@12': inf, 'MSE@12': 1133.06527106459, 'RMSE@12': 33.66103490780683, 'masked_MAE@12': 20.96465725309513, 'masked_MAPE@12': 0.18307669544446992, 'masked_MSE@12': 1035.9889960420694, 'masked_RMSE@12': 32.18678294023914, 'R2@12': 0.9546146270938212, 'EVAR@12': 0.9546432782528077}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:20:44,102 - INFO - epoch complete!
2023-05-12 02:20:44,103 - INFO - validating now!
2023-05-12 02:21:07,583 - INFO - Epoch [55/100] train_loss: 20.5337, val_loss: 22.3210, lr: 0.010000, 183.63s
2023-05-12 02:21:07,583 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:21:38,675 - INFO - Evaluate result of 55 is {'MAE@12': 22.475496275674093, 'MAPE@12': inf, 'MSE@12': 1213.9433617513173, 'RMSE@12': 34.841689995626176, 'masked_MAE@12': 22.215373768391455, 'masked_MAPE@12': 0.20287205685042195, 'masked_MSE@12': 1124.7427740828073, 'masked_RMSE@12': 33.53718494571074, 'R2@12': 0.951375023516255, 'EVAR@12': 0.9518811292715902}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:24:18,733 - INFO - epoch complete!
2023-05-12 02:24:18,734 - INFO - validating now!
2023-05-12 02:24:42,489 - INFO - Epoch [56/100] train_loss: 20.4016, val_loss: 21.1433, lr: 0.010000, 183.81s
2023-05-12 02:24:42,490 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:25:14,644 - INFO - Evaluate result of 56 is {'MAE@12': 21.14788120946783, 'MAPE@12': inf, 'MSE@12': 1125.2733632646014, 'RMSE@12': 33.545094473925715, 'masked_MAE@12': 20.87791667289615, 'masked_MAPE@12': 0.17591956044708437, 'masked_MSE@12': 1027.700872236635, 'masked_RMSE@12': 32.05777397506937, 'R2@12': 0.954926735010447, 'EVAR@12': 0.9550399934322225}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:27:54,394 - INFO - epoch complete!
2023-05-12 02:27:54,395 - INFO - validating now!
2023-05-12 02:28:18,530 - INFO - Epoch [57/100] train_loss: 20.2749, val_loss: 20.9113, lr: 0.010000, 183.89s
2023-05-12 02:28:18,531 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:28:48,464 - INFO - Evaluate result of 57 is {'MAE@12': 20.889512277341584, 'MAPE@12': inf, 'MSE@12': 1122.954614212178, 'RMSE@12': 33.5105149798116, 'masked_MAE@12': 20.694604592418322, 'masked_MAPE@12': 0.14365811616489663, 'masked_MSE@12': 1025.6040272027494, 'masked_RMSE@12': 32.02505311787554, 'R2@12': 0.9550196134112836, 'EVAR@12': 0.9553541545466675}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:31:28,268 - INFO - epoch complete!
2023-05-12 02:31:28,268 - INFO - validating now!
2023-05-12 02:31:52,401 - INFO - Epoch [58/100] train_loss: 20.5091, val_loss: 21.2510, lr: 0.010000, 183.94s
2023-05-12 02:31:52,402 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:32:21,711 - INFO - Evaluate result of 58 is {'MAE@12': 21.40064612806778, 'MAPE@12': inf, 'MSE@12': 1163.7988500045303, 'RMSE@12': 34.114496185705725, 'masked_MAE@12': 21.1705890018794, 'masked_MAPE@12': 0.16462326161646032, 'masked_MSE@12': 1073.753535230839, 'masked_RMSE@12': 32.76817869871377, 'R2@12': 0.9533835815604778, 'EVAR@12': 0.9539065614617898}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:35:01,275 - INFO - epoch complete!
2023-05-12 02:35:01,276 - INFO - validating now!
2023-05-12 02:35:25,246 - INFO - Epoch [59/100] train_loss: 20.4194, val_loss: 21.2221, lr: 0.010000, 183.53s
2023-05-12 02:35:25,246 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:35:54,581 - INFO - Evaluate result of 59 is {'MAE@12': 20.962997987838598, 'MAPE@12': inf, 'MSE@12': 1136.6957899586303, 'RMSE@12': 33.71491939718424, 'masked_MAE@12': 20.793622893288227, 'masked_MAPE@12': 0.1494675384925358, 'masked_MSE@12': 1055.6669615468825, 'masked_RMSE@12': 32.49102893949163, 'R2@12': 0.954469205238561, 'EVAR@12': 0.9544750751312019}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:38:34,607 - INFO - epoch complete!
2023-05-12 02:38:34,608 - INFO - validating now!
2023-05-12 02:38:58,299 - INFO - Epoch [60/100] train_loss: 21.8766, val_loss: 23.1767, lr: 0.010000, 183.72s
2023-05-12 02:38:58,299 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:39:27,387 - INFO - Evaluate result of 60 is {'MAE@12': 22.833600566400946, 'MAPE@12': inf, 'MSE@12': 1326.4651697530805, 'RMSE@12': 36.42066954015371, 'masked_MAE@12': 22.582715596108613, 'masked_MAPE@12': 0.17063516461984693, 'masked_MSE@12': 1170.4790569646186, 'masked_RMSE@12': 34.212264715517136, 'R2@12': 0.9468679184565092, 'EVAR@12': 0.9475564671685264}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:42:07,415 - INFO - epoch complete!
2023-05-12 02:42:07,415 - INFO - validating now!
2023-05-12 02:42:30,134 - INFO - Epoch [61/100] train_loss: 21.5852, val_loss: 21.7380, lr: 0.010000, 182.75s
2023-05-12 02:42:30,135 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:42:59,488 - INFO - Evaluate result of 61 is {'MAE@12': 21.7469705834093, 'MAPE@12': inf, 'MSE@12': 1177.1330600455678, 'RMSE@12': 34.30937277254669, 'masked_MAE@12': 21.44437433666993, 'masked_MAPE@12': 0.19761110155108905, 'masked_MSE@12': 1075.2511186051022, 'masked_RMSE@12': 32.79102192071943, 'R2@12': 0.9528494745583689, 'EVAR@12': 0.9528822335310048}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:45:39,535 - INFO - epoch complete!
2023-05-12 02:45:39,535 - INFO - validating now!
2023-05-12 02:46:02,486 - INFO - Epoch [62/100] train_loss: 21.1146, val_loss: 21.3693, lr: 0.010000, 183.00s
2023-05-12 02:46:02,486 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:46:31,630 - INFO - Evaluate result of 62 is {'MAE@12': 21.212455729824374, 'MAPE@12': inf, 'MSE@12': 1183.360359710616, 'RMSE@12': 34.40000522835158, 'masked_MAE@12': 20.99770311320884, 'masked_MAPE@12': 0.14832027480797808, 'masked_MSE@12': 1070.456887596579, 'masked_RMSE@12': 32.717837452933516, 'R2@12': 0.9526000376329646, 'EVAR@12': 0.9526270652040438}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:49:11,916 - INFO - epoch complete!
2023-05-12 02:49:11,917 - INFO - validating now!
2023-05-12 02:49:34,806 - INFO - Epoch [63/100] train_loss: 20.8472, val_loss: 21.9201, lr: 0.010000, 183.18s
2023-05-12 02:49:34,807 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:50:03,719 - INFO - Evaluate result of 63 is {'MAE@12': 22.158179873269603, 'MAPE@12': inf, 'MSE@12': 1213.3459181525639, 'RMSE@12': 34.833115251905966, 'masked_MAE@12': 21.80178523693854, 'masked_MAPE@12': 0.2087818565591199, 'masked_MSE@12': 1086.4723668009956, 'masked_RMSE@12': 32.9616802787873, 'R2@12': 0.9513989543534382, 'EVAR@12': 0.9514671995881692}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:52:43,760 - INFO - epoch complete!
2023-05-12 02:52:43,761 - INFO - validating now!
2023-05-12 02:53:06,417 - INFO - Epoch [64/100] train_loss: 20.8245, val_loss: 21.7836, lr: 0.010000, 182.70s
2023-05-12 02:53:06,417 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:53:34,800 - INFO - Evaluate result of 64 is {'MAE@12': 21.699601346283984, 'MAPE@12': inf, 'MSE@12': 1161.0109119750473, 'RMSE@12': 34.073610198730734, 'masked_MAE@12': 21.572280934516762, 'masked_MAPE@12': 0.15152749271560306, 'masked_MSE@12': 1088.4494155446764, 'masked_RMSE@12': 32.99165675659039, 'R2@12': 0.9534952535094277, 'EVAR@12': 0.9543829901273492}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:56:15,073 - INFO - epoch complete!
2023-05-12 02:56:15,074 - INFO - validating now!
2023-05-12 02:56:37,849 - INFO - Epoch [65/100] train_loss: 21.7433, val_loss: 26.1668, lr: 0.010000, 183.05s
2023-05-12 02:56:37,850 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 02:57:06,819 - INFO - Evaluate result of 65 is {'MAE@12': 25.323459802534504, 'MAPE@12': inf, 'MSE@12': 1445.1051046774858, 'RMSE@12': 38.01453807002639, 'masked_MAE@12': 25.30129198674012, 'masked_MAPE@12': 0.19235989810960127, 'masked_MSE@12': 1419.0194205045682, 'masked_RMSE@12': 37.669874176914476, 'R2@12': 0.9421157494282855, 'EVAR@12': 0.9422895254712197}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 02:59:46,989 - INFO - epoch complete!
2023-05-12 02:59:46,990 - INFO - validating now!
2023-05-12 03:00:09,720 - INFO - Epoch [66/100] train_loss: 22.5628, val_loss: 22.2886, lr: 0.010000, 182.90s
2023-05-12 03:00:09,720 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:00:38,708 - INFO - Evaluate result of 66 is {'MAE@12': 21.994679609154357, 'MAPE@12': inf, 'MSE@12': 1153.5338311582989, 'RMSE@12': 33.96371344771209, 'masked_MAE@12': 21.87415384722627, 'masked_MAPE@12': 0.19005404590373928, 'masked_MSE@12': 1113.5241955628117, 'masked_RMSE@12': 33.36950996887445, 'R2@12': 0.9537947509080188, 'EVAR@12': 0.9539688889626208}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:03:19,024 - INFO - epoch complete!
2023-05-12 03:03:19,024 - INFO - validating now!
2023-05-12 03:03:41,744 - INFO - Epoch [67/100] train_loss: 22.0387, val_loss: 24.5622, lr: 0.010000, 183.03s
2023-05-12 03:03:41,744 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:04:10,843 - INFO - Evaluate result of 67 is {'MAE@12': 24.35550404325564, 'MAPE@12': inf, 'MSE@12': 1399.752318322119, 'RMSE@12': 37.41326393569691, 'masked_MAE@12': 24.295059956789654, 'masked_MAPE@12': 0.19362044054465455, 'masked_MSE@12': 1374.8895630723607, 'masked_RMSE@12': 37.07950327434769, 'R2@12': 0.9439323730365077, 'EVAR@12': 0.946203509455178}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:06:51,047 - INFO - epoch complete!
2023-05-12 03:06:51,047 - INFO - validating now!
2023-05-12 03:07:13,778 - INFO - Epoch [68/100] train_loss: 21.5544, val_loss: 21.6831, lr: 0.010000, 182.93s
2023-05-12 03:07:13,778 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:07:42,771 - INFO - Evaluate result of 68 is {'MAE@12': 21.44402993302244, 'MAPE@12': inf, 'MSE@12': 1171.7759062567427, 'RMSE@12': 34.231212456714744, 'masked_MAE@12': 21.324259465934354, 'masked_MAPE@12': 0.15241951681761232, 'masked_MSE@12': 1097.2615935258216, 'masked_RMSE@12': 33.124939147503675, 'R2@12': 0.9530640574501322, 'EVAR@12': 0.9531815885458345}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:10:23,427 - INFO - epoch complete!
2023-05-12 03:10:23,428 - INFO - validating now!
2023-05-12 03:10:46,234 - INFO - Epoch [69/100] train_loss: 21.1997, val_loss: 21.8903, lr: 0.010000, 183.46s
2023-05-12 03:10:46,235 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:11:15,236 - INFO - Evaluate result of 69 is {'MAE@12': 21.699852852243676, 'MAPE@12': inf, 'MSE@12': 1183.5756472054284, 'RMSE@12': 34.40313426427058, 'masked_MAE@12': 21.549057707153, 'masked_MAPE@12': 0.15436018958738124, 'masked_MSE@12': 1103.416943248904, 'masked_RMSE@12': 33.217720319866984, 'R2@12': 0.952591414208098, 'EVAR@12': 0.9525923156722403}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:13:55,772 - INFO - epoch complete!
2023-05-12 03:13:55,773 - INFO - validating now!
2023-05-12 03:14:18,488 - INFO - Epoch [70/100] train_loss: 21.0221, val_loss: 21.5289, lr: 0.010000, 183.25s
2023-05-12 03:14:18,488 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:14:47,653 - INFO - Evaluate result of 70 is {'MAE@12': 21.449373683393553, 'MAPE@12': inf, 'MSE@12': 1154.403007318807, 'RMSE@12': 33.976506696816365, 'masked_MAE@12': 21.235429017570862, 'masked_MAPE@12': 0.16885106169039144, 'masked_MSE@12': 1072.929903369034, 'masked_RMSE@12': 32.75560873146817, 'R2@12': 0.9537599357167204, 'EVAR@12': 0.9538383540094941}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:17:28,165 - INFO - epoch complete!
2023-05-12 03:17:28,165 - INFO - validating now!
2023-05-12 03:17:51,205 - INFO - Epoch [71/100] train_loss: 20.8099, val_loss: 21.6888, lr: 0.010000, 183.55s
2023-05-12 03:17:51,206 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:18:20,326 - INFO - Evaluate result of 71 is {'MAE@12': 21.602011881599246, 'MAPE@12': inf, 'MSE@12': 1160.0954585091058, 'RMSE@12': 34.06017408219027, 'masked_MAE@12': 21.389165546883007, 'masked_MAPE@12': 0.18068277367923316, 'masked_MSE@12': 1072.283800921113, 'masked_RMSE@12': 32.74574477578901, 'R2@12': 0.953531922356308, 'EVAR@12': 0.9537480502724475}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:21:00,870 - INFO - epoch complete!
2023-05-12 03:21:00,870 - INFO - validating now!
2023-05-12 03:21:23,518 - INFO - Epoch [72/100] train_loss: 20.9499, val_loss: 21.1289, lr: 0.010000, 183.19s
2023-05-12 03:21:23,519 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:21:53,058 - INFO - Evaluate result of 72 is {'MAE@12': 20.981454990296537, 'MAPE@12': inf, 'MSE@12': 1116.543672184702, 'RMSE@12': 33.41472238676691, 'masked_MAE@12': 20.844416710996768, 'masked_MAPE@12': 0.14935611376701163, 'masked_MSE@12': 1047.5002375160623, 'masked_RMSE@12': 32.36510833468756, 'R2@12': 0.9552764062033913, 'EVAR@12': 0.9554567324001761}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:24:33,386 - INFO - epoch complete!
2023-05-12 03:24:33,386 - INFO - validating now!
2023-05-12 03:24:56,069 - INFO - Epoch [73/100] train_loss: 20.5636, val_loss: 21.2253, lr: 0.010000, 183.01s
2023-05-12 03:24:56,070 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:25:25,495 - INFO - Evaluate result of 73 is {'MAE@12': 21.123270527303006, 'MAPE@12': inf, 'MSE@12': 1123.7867730014561, 'RMSE@12': 33.52292906357462, 'masked_MAE@12': 20.91989722145643, 'masked_MAPE@12': 0.17358775129327422, 'masked_MSE@12': 1047.5116483728168, 'masked_RMSE@12': 32.36528461751598, 'R2@12': 0.9549862809652782, 'EVAR@12': 0.9550055180186849}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:28:05,482 - INFO - epoch complete!
2023-05-12 03:28:05,482 - INFO - validating now!
2023-05-12 03:28:28,072 - INFO - Epoch [74/100] train_loss: 20.4876, val_loss: 21.0030, lr: 0.010000, 182.58s
2023-05-12 03:28:28,073 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:28:57,309 - INFO - Evaluate result of 74 is {'MAE@12': 20.920506462444056, 'MAPE@12': inf, 'MSE@12': 1124.930808479386, 'RMSE@12': 33.539988200346556, 'masked_MAE@12': 20.759920554744365, 'masked_MAPE@12': 0.15201602535447137, 'masked_MSE@12': 1044.7845627856948, 'masked_RMSE@12': 32.323127367036975, 'R2@12': 0.9549404561764423, 'EVAR@12': 0.955002464806707}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:31:36,523 - INFO - epoch complete!
2023-05-12 03:31:36,523 - INFO - validating now!
2023-05-12 03:31:59,252 - INFO - Epoch [75/100] train_loss: 21.0186, val_loss: 21.4941, lr: 0.010000, 181.94s
2023-05-12 03:31:59,253 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:32:28,604 - INFO - Evaluate result of 75 is {'MAE@12': 21.409345274994553, 'MAPE@12': inf, 'MSE@12': 1143.5234479544583, 'RMSE@12': 33.8160235384715, 'masked_MAE@12': 21.294894146155023, 'masked_MAPE@12': 0.1520682811465096, 'masked_MSE@12': 1071.1998818640125, 'masked_RMSE@12': 32.72919005817303, 'R2@12': 0.9541957207252415, 'EVAR@12': 0.9546688807756257}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:35:09,029 - INFO - epoch complete!
2023-05-12 03:35:09,029 - INFO - validating now!
2023-05-12 03:35:32,035 - INFO - Epoch [76/100] train_loss: 21.1913, val_loss: 21.8111, lr: 0.010000, 183.43s
2023-05-12 03:35:32,035 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:36:01,404 - INFO - Evaluate result of 76 is {'MAE@12': 21.647761830542304, 'MAPE@12': inf, 'MSE@12': 1194.4910522582463, 'RMSE@12': 34.56140987081179, 'masked_MAE@12': 21.381742278474434, 'masked_MAPE@12': 0.1738058871874654, 'masked_MSE@12': 1085.023299933377, 'masked_RMSE@12': 32.93969186154262, 'R2@12': 0.9521541933864954, 'EVAR@12': 0.9528615795919315}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:38:41,512 - INFO - epoch complete!
2023-05-12 03:38:41,512 - INFO - validating now!
2023-05-12 03:39:04,494 - INFO - Epoch [77/100] train_loss: 20.9186, val_loss: 21.5091, lr: 0.010000, 183.09s
2023-05-12 03:39:04,495 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:39:34,674 - INFO - Evaluate result of 77 is {'MAE@12': 21.46842032025275, 'MAPE@12': inf, 'MSE@12': 1157.312154173967, 'RMSE@12': 34.01929091227457, 'masked_MAE@12': 21.237681202758786, 'masked_MAPE@12': 0.17114264902105203, 'masked_MSE@12': 1070.958730376471, 'masked_RMSE@12': 32.725505807801824, 'R2@12': 0.9536434087008174, 'EVAR@12': 0.9540840556384746}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:42:15,894 - INFO - epoch complete!
2023-05-12 03:42:15,894 - INFO - validating now!
2023-05-12 03:42:39,270 - INFO - Epoch [78/100] train_loss: 20.8761, val_loss: 21.7010, lr: 0.010000, 184.60s
2023-05-12 03:42:39,270 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:43:09,706 - INFO - Evaluate result of 78 is {'MAE@12': 21.863576711657068, 'MAPE@12': inf, 'MSE@12': 1145.9294629406104, 'RMSE@12': 33.85157991793899, 'masked_MAE@12': 21.717062556864533, 'masked_MAPE@12': 0.18126528220217522, 'masked_MSE@12': 1102.526893769634, 'masked_RMSE@12': 33.20432040818836, 'R2@12': 0.954099346853274, 'EVAR@12': 0.9545339251666727}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:45:51,909 - INFO - epoch complete!
2023-05-12 03:45:51,910 - INFO - validating now!
2023-05-12 03:46:15,965 - INFO - Epoch [79/100] train_loss: 20.7440, val_loss: 21.8883, lr: 0.010000, 186.26s
2023-05-12 03:46:15,965 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:46:46,773 - INFO - Evaluate result of 79 is {'MAE@12': 21.812303110886162, 'MAPE@12': inf, 'MSE@12': 1189.6001865344188, 'RMSE@12': 34.49058112781544, 'masked_MAE@12': 21.661134479047828, 'masked_MAPE@12': 0.1546864325191913, 'masked_MSE@12': 1092.7593852640146, 'masked_RMSE@12': 33.05691130859044, 'R2@12': 0.9523500989273135, 'EVAR@12': 0.9533791808198602}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:49:30,260 - INFO - epoch complete!
2023-05-12 03:49:30,261 - INFO - validating now!
2023-05-12 03:49:54,367 - INFO - Epoch [80/100] train_loss: 20.5858, val_loss: 21.7330, lr: 0.010000, 187.59s
2023-05-12 03:49:54,367 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:50:25,253 - INFO - Evaluate result of 80 is {'MAE@12': 21.82694364816808, 'MAPE@12': inf, 'MSE@12': 1175.957097235733, 'RMSE@12': 34.2922308582532, 'masked_MAE@12': 21.575886151896576, 'masked_MAPE@12': 0.1778739108882342, 'masked_MSE@12': 1094.4177097173874, 'masked_RMSE@12': 33.08198467017037, 'R2@12': 0.9528965782089803, 'EVAR@12': 0.9534805806423102}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:53:08,289 - INFO - epoch complete!
2023-05-12 03:53:08,289 - INFO - validating now!
2023-05-12 03:53:32,053 - INFO - Epoch [81/100] train_loss: 21.9062, val_loss: 22.9897, lr: 0.010000, 186.80s
2023-05-12 03:53:32,054 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:54:03,049 - INFO - Evaluate result of 81 is {'MAE@12': 23.23967058707483, 'MAPE@12': inf, 'MSE@12': 1251.19703123718, 'RMSE@12': 35.37226358656144, 'masked_MAE@12': 23.06618653127408, 'masked_MAPE@12': 0.1987081045508161, 'masked_MSE@12': 1204.8968723870694, 'masked_RMSE@12': 34.71162445618282, 'R2@12': 0.9498828132041774, 'EVAR@12': 0.9511774433392574}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 03:56:45,911 - INFO - epoch complete!
2023-05-12 03:56:45,911 - INFO - validating now!
2023-05-12 03:57:09,304 - INFO - Epoch [82/100] train_loss: 21.4890, val_loss: 22.6020, lr: 0.010000, 186.25s
2023-05-12 03:57:09,305 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 03:57:39,760 - INFO - Evaluate result of 82 is {'MAE@12': 22.251224172610804, 'MAPE@12': inf, 'MSE@12': 1203.7543485160247, 'RMSE@12': 34.695163186185255, 'masked_MAE@12': 22.117409818083303, 'masked_MAPE@12': 0.17641973561610574, 'masked_MSE@12': 1148.8926631624997, 'masked_RMSE@12': 33.89531919251535, 'R2@12': 0.9517831484293019, 'EVAR@12': 0.9521653283063508}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:00:23,210 - INFO - epoch complete!
2023-05-12 04:00:23,211 - INFO - validating now!
2023-05-12 04:00:47,037 - INFO - Epoch [83/100] train_loss: 21.0775, val_loss: 21.5559, lr: 0.010000, 187.28s
2023-05-12 04:00:47,037 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:01:18,242 - INFO - Evaluate result of 83 is {'MAE@12': 21.48023909830729, 'MAPE@12': inf, 'MSE@12': 1163.6359644590698, 'RMSE@12': 34.11210876593633, 'masked_MAE@12': 21.262855958531752, 'masked_MAPE@12': 0.1669082494949995, 'masked_MSE@12': 1072.7330014575102, 'masked_RMSE@12': 32.75260297224497, 'R2@12': 0.9533901060047534, 'EVAR@12': 0.953604659590284}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:04:01,739 - INFO - epoch complete!
2023-05-12 04:04:01,739 - INFO - validating now!
2023-05-12 04:04:25,145 - INFO - Epoch [84/100] train_loss: 20.7849, val_loss: 21.9180, lr: 0.010000, 186.90s
2023-05-12 04:04:25,146 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:04:55,592 - INFO - Evaluate result of 84 is {'MAE@12': 21.933580224505302, 'MAPE@12': inf, 'MSE@12': 1169.1667448839123, 'RMSE@12': 34.19308036553467, 'masked_MAE@12': 21.740017480913657, 'masked_MAPE@12': 0.18999928451117692, 'masked_MSE@12': 1094.3935828387068, 'masked_RMSE@12': 33.081620015330365, 'R2@12': 0.9531685684301282, 'EVAR@12': 0.9531921388942173}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:07:38,667 - INFO - epoch complete!
2023-05-12 04:07:38,667 - INFO - validating now!
2023-05-12 04:08:02,115 - INFO - Epoch [85/100] train_loss: 21.4619, val_loss: 25.7368, lr: 0.010000, 186.52s
2023-05-12 04:08:02,116 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:08:32,772 - INFO - Evaluate result of 85 is {'MAE@12': 24.976811921410388, 'MAPE@12': inf, 'MSE@12': 1322.1670512396477, 'RMSE@12': 36.36161508018652, 'masked_MAE@12': 24.97716232185207, 'masked_MAPE@12': 0.2254901278324853, 'masked_MSE@12': 1294.0735814591849, 'masked_RMSE@12': 35.97323423684872, 'R2@12': 0.9470400812758176, 'EVAR@12': 0.9485440171790707}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:11:15,332 - INFO - epoch complete!
2023-05-12 04:11:15,332 - INFO - validating now!
2023-05-12 04:11:39,084 - INFO - Epoch [86/100] train_loss: 22.4757, val_loss: 23.1327, lr: 0.010000, 186.31s
2023-05-12 04:11:39,084 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:12:10,684 - INFO - Evaluate result of 86 is {'MAE@12': 22.828109536407737, 'MAPE@12': inf, 'MSE@12': 1210.9082702337764, 'RMSE@12': 34.79810727947393, 'masked_MAE@12': 22.664295940712023, 'masked_MAPE@12': 0.2057258996586857, 'masked_MSE@12': 1164.7667377899777, 'masked_RMSE@12': 34.12867910995059, 'R2@12': 0.9514965952949034, 'EVAR@12': 0.9519168701814992}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:14:53,784 - INFO - epoch complete!
2023-05-12 04:14:53,784 - INFO - validating now!
2023-05-12 04:15:17,125 - INFO - Epoch [87/100] train_loss: 21.5794, val_loss: 22.1373, lr: 0.010000, 186.44s
2023-05-12 04:15:17,125 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:15:47,989 - INFO - Evaluate result of 87 is {'MAE@12': 21.744285169102618, 'MAPE@12': inf, 'MSE@12': 1176.8378335804387, 'RMSE@12': 34.30507008563659, 'masked_MAE@12': 21.590103660065687, 'masked_MAPE@12': 0.1579389745484426, 'masked_MSE@12': 1104.0869434998833, 'masked_RMSE@12': 33.22780377183968, 'R2@12': 0.9528612999699793, 'EVAR@12': 0.953136495320198}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:18:28,482 - INFO - epoch complete!
2023-05-12 04:18:28,483 - INFO - validating now!
2023-05-12 04:18:51,979 - INFO - Epoch [88/100] train_loss: 22.0813, val_loss: 22.2672, lr: 0.010000, 183.99s
2023-05-12 04:18:51,979 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:19:22,351 - INFO - Evaluate result of 88 is {'MAE@12': 21.75673374195799, 'MAPE@12': inf, 'MSE@12': 1166.016370177442, 'RMSE@12': 34.146981860443276, 'masked_MAE@12': 21.717616240830704, 'masked_MAPE@12': 0.15678971873187592, 'masked_MSE@12': 1116.6002988526513, 'masked_RMSE@12': 33.415569707138786, 'R2@12': 0.9532947579220301, 'EVAR@12': 0.9533601799413514}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:22:02,514 - INFO - epoch complete!
2023-05-12 04:22:02,514 - INFO - validating now!
2023-05-12 04:22:24,990 - INFO - Epoch [89/100] train_loss: 21.2547, val_loss: 22.1843, lr: 0.010000, 182.64s
2023-05-12 04:22:24,991 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:22:54,869 - INFO - Evaluate result of 89 is {'MAE@12': 22.18297379325082, 'MAPE@12': inf, 'MSE@12': 1204.4122457796086, 'RMSE@12': 34.70464300031926, 'masked_MAE@12': 22.010481105694605, 'masked_MAPE@12': 0.1665616325836684, 'masked_MSE@12': 1131.6642466864953, 'masked_RMSE@12': 33.64021769677621, 'R2@12': 0.9517567960969127, 'EVAR@12': 0.9523427723552285}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:25:33,777 - INFO - epoch complete!
2023-05-12 04:25:33,778 - INFO - validating now!
2023-05-12 04:25:56,213 - INFO - Epoch [90/100] train_loss: 21.1543, val_loss: 22.5072, lr: 0.010000, 181.34s
2023-05-12 04:25:56,214 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:26:26,110 - INFO - Evaluate result of 90 is {'MAE@12': 22.515942934760144, 'MAPE@12': inf, 'MSE@12': 1239.9242875626858, 'RMSE@12': 35.212558662538086, 'masked_MAE@12': 22.378737696256096, 'masked_MAPE@12': 0.16065972040886928, 'masked_MSE@12': 1165.125918801447, 'masked_RMSE@12': 34.13394086245312, 'R2@12': 0.950334347364131, 'EVAR@12': 0.9516276925208677}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:29:05,125 - INFO - epoch complete!
2023-05-12 04:29:05,126 - INFO - validating now!
2023-05-12 04:29:27,641 - INFO - Epoch [91/100] train_loss: 20.9082, val_loss: 24.2678, lr: 0.010000, 181.53s
2023-05-12 04:29:27,642 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:29:57,488 - INFO - Evaluate result of 91 is {'MAE@12': 24.370271977178863, 'MAPE@12': inf, 'MSE@12': 1292.240778102533, 'RMSE@12': 35.947750668192484, 'masked_MAE@12': 24.286256646333463, 'masked_MAPE@12': 0.1985581594680451, 'masked_MSE@12': 1240.4904113663583, 'masked_RMSE@12': 35.22059640844201, 'R2@12': 0.9482387898592552, 'EVAR@12': 0.9512804499097196}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:32:36,592 - INFO - epoch complete!
2023-05-12 04:32:36,593 - INFO - validating now!
2023-05-12 04:32:59,106 - INFO - Epoch [92/100] train_loss: 21.0004, val_loss: 21.9632, lr: 0.010000, 181.62s
2023-05-12 04:32:59,106 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:33:28,868 - INFO - Evaluate result of 92 is {'MAE@12': 21.988460736368257, 'MAPE@12': inf, 'MSE@12': 1185.7662879631914, 'RMSE@12': 34.43495735387502, 'masked_MAE@12': 21.871733393868908, 'masked_MAPE@12': 0.158885067428644, 'masked_MSE@12': 1116.1454838843808, 'masked_RMSE@12': 33.408763579102725, 'R2@12': 0.9525036672351447, 'EVAR@12': 0.9533164930978318}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:36:07,895 - INFO - epoch complete!
2023-05-12 04:36:07,896 - INFO - validating now!
2023-05-12 04:36:30,502 - INFO - Epoch [93/100] train_loss: 20.9994, val_loss: 21.9364, lr: 0.010000, 181.63s
2023-05-12 04:36:30,502 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:37:01,125 - INFO - Evaluate result of 93 is {'MAE@12': 21.876629863671674, 'MAPE@12': inf, 'MSE@12': 1209.3259745823718, 'RMSE@12': 34.775364478066535, 'masked_MAE@12': 21.69515598202228, 'masked_MAPE@12': 0.15267198029221402, 'masked_MSE@12': 1112.982923216709, 'masked_RMSE@12': 33.361398699945255, 'R2@12': 0.9515599747665195, 'EVAR@12': 0.9522275040889832}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:39:40,690 - INFO - epoch complete!
2023-05-12 04:39:40,691 - INFO - validating now!
2023-05-12 04:40:03,285 - INFO - Epoch [94/100] train_loss: 20.7727, val_loss: 22.0507, lr: 0.010000, 182.16s
2023-05-12 04:40:03,286 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:40:33,283 - INFO - Evaluate result of 94 is {'MAE@12': 22.007572513897028, 'MAPE@12': inf, 'MSE@12': 1145.8960846536195, 'RMSE@12': 33.851086905055496, 'masked_MAE@12': 21.810110750216445, 'masked_MAPE@12': 0.20275437456652498, 'masked_MSE@12': 1086.4196609132305, 'masked_RMSE@12': 32.96088076664867, 'R2@12': 0.9541006838336233, 'EVAR@12': 0.9541182924482923}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:43:12,899 - INFO - epoch complete!
2023-05-12 04:43:12,900 - INFO - validating now!
2023-05-12 04:43:35,805 - INFO - Epoch [95/100] train_loss: 20.6087, val_loss: 22.9581, lr: 0.010000, 182.52s
2023-05-12 04:43:35,806 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:44:05,748 - INFO - Evaluate result of 95 is {'MAE@12': 22.672007728121, 'MAPE@12': inf, 'MSE@12': 1200.145640475141, 'RMSE@12': 34.64311822678699, 'masked_MAE@12': 22.606109132290108, 'masked_MAPE@12': 0.18655335297678785, 'masked_MSE@12': 1116.345356560552, 'masked_RMSE@12': 33.41175476625782, 'R2@12': 0.951927696642302, 'EVAR@12': 0.9529368514248597}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:46:45,382 - INFO - epoch complete!
2023-05-12 04:46:45,383 - INFO - validating now!
2023-05-12 04:47:08,099 - INFO - Epoch [96/100] train_loss: 21.0386, val_loss: 22.1855, lr: 0.010000, 182.35s
2023-05-12 04:47:08,100 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:47:38,597 - INFO - Evaluate result of 96 is {'MAE@12': 21.920625379372783, 'MAPE@12': inf, 'MSE@12': 1149.186444906593, 'RMSE@12': 33.89965257796299, 'masked_MAE@12': 21.806850478252542, 'masked_MAPE@12': 0.19452131473549816, 'masked_MSE@12': 1102.1931895329565, 'masked_RMSE@12': 33.199295015601706, 'R2@12': 0.9539688871658669, 'EVAR@12': 0.9540121310309838}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:50:18,597 - INFO - epoch complete!
2023-05-12 04:50:18,598 - INFO - validating now!
2023-05-12 04:50:41,418 - INFO - Epoch [97/100] train_loss: 21.4185, val_loss: 22.8993, lr: 0.010000, 182.82s
2023-05-12 04:50:41,418 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:51:12,287 - INFO - Evaluate result of 97 is {'MAE@12': 23.028738952827815, 'MAPE@12': inf, 'MSE@12': 1276.7955788507609, 'RMSE@12': 35.73227642973172, 'masked_MAE@12': 22.64147842510598, 'masked_MAPE@12': 0.24369719202678664, 'masked_MSE@12': 1151.9362802224437, 'masked_RMSE@12': 33.940186802998646, 'R2@12': 0.948857453360426, 'EVAR@12': 0.9488577886263273}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:53:52,121 - INFO - epoch complete!
2023-05-12 04:53:52,122 - INFO - validating now!
2023-05-12 04:54:14,974 - INFO - Epoch [98/100] train_loss: 21.1075, val_loss: 22.2335, lr: 0.010000, 182.69s
2023-05-12 04:54:14,975 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:54:45,384 - INFO - Evaluate result of 98 is {'MAE@12': 22.22867476417859, 'MAPE@12': inf, 'MSE@12': 1214.405958489644, 'RMSE@12': 34.84832791526222, 'masked_MAE@12': 22.037912926868643, 'masked_MAPE@12': 0.167326451751193, 'masked_MSE@12': 1122.2782276814762, 'masked_RMSE@12': 33.500421306029516, 'R2@12': 0.9513564940228442, 'EVAR@12': 0.9521645757405554}
/home/bao/xfli/course/tst/ST_transformer/libcity/model/traffic_flow_prediction/layers/pe_layers.py:132: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()
2023-05-12 04:57:25,046 - INFO - epoch complete!
2023-05-12 04:57:25,046 - INFO - validating now!
2023-05-12 04:57:47,657 - INFO - Epoch [99/100] train_loss: 21.0830, val_loss: 23.0986, lr: 0.010000, 182.27s
2023-05-12 04:57:47,658 - INFO - Extensive metrics on test dataset (for reference)
2023-05-12 04:58:17,376 - INFO - Evaluate result of 99 is {'MAE@12': 23.26593472739218, 'MAPE@12': inf, 'MSE@12': 1266.860249015095, 'RMSE@12': 35.592980333418204, 'masked_MAE@12': 22.954241844914307, 'masked_MAPE@12': 0.231125063709789, 'masked_MSE@12': 1147.3031897027945, 'masked_RMSE@12': 33.871864278524654, 'R2@12': 0.949255416885611, 'EVAR@12': 0.9492598784756033}
2023-05-12 04:58:17,377 - INFO - Trained totally 100 epochs, average train time is 160.494s, average eval time is 23.128s
Traceback (most recent call last):
  File "/home/bao/xfli/course/tst/ST_transformer/libcity/pipeline/pipeline.py", line 59, in run_model
    executor.train(train_data, valid_data)
TypeError: TrafficStateExecutorTest.train() missing 1 required positional argument: 'test_dataloader'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/bao/xfli/course/tst/ST_transformer/run_model.py", line 39, in <module>
    run_model(task=args.task, model_name=args.model, dataset_name=args.dataset,
  File "/home/bao/xfli/course/tst/ST_transformer/libcity/pipeline/pipeline.py", line 61, in run_model
    executor.train(train_data, valid_data, test_data)
  File "/home/bao/xfli/course/tst/ST_transformer/libcity/executor/traffic_state_executor_evaltest.py", line 379, in train
    self.load_model_with_epoch(best_epoch)
  File "/home/bao/xfli/course/tst/ST_transformer/libcity/executor/traffic_state_executor_evaltest.py", line 131, in load_model_with_epoch
    assert os.path.exists(model_path), 'Weights at epoch %d not found' % epoch
AssertionError: Weights at epoch 51 not found
